{% comment %}
Smart Breadcrumbs App Block v2.0.0
This block determines which breadcrumb template to render based on the current page type
and applies merchant-defined styling preferences.
{% endcomment %}

{{ 'breadcrumb-styles.css' | asset_url | stylesheet_tag }}

<style>
  #shopify-section-{{ section.id }} .smart-breadcrumb {
    background-color: {{ block.settings.background_color }};
    color: {{ block.settings.text_color }};
  }
  
  #shopify-section-{{ section.id }} .smart-breadcrumb a {
    color: {{ block.settings.link_color }};
  }
  
  #shopify-section-{{ section.id }} .smart-breadcrumb__item:not(:last-child)::after {
    content: "{{ block.settings.separator }}";
  }
  
  {% if block.settings.hide_on_mobile %}
    @media screen and (max-width: 749px) {
      #shopify-section-{{ section.id }} {
        display: none;
      }
    }
  {% endif %}
</style>

{% assign debug_mode = false %}
{% if request.query_string contains 'debug_breadcrumbs=true' %}
  {% assign debug_mode = true %}
{% endif %}

{% assign template_type = template.name %}
{% if template_type == 'index' %}
  {% assign template_type = 'page' %}
{% endif %}

{% case template_type %}
  {% when 'product' %}
    {% render 'smart-breadcrumbs-product', 
      debug_mode: debug_mode,
      enable_schema: block.settings.enable_schema
    %}
  {% when 'collection' %}
    {% render 'smart-breadcrumbs-collection',
      debug_mode: debug_mode,
      enable_schema: block.settings.enable_schema
    %}
  {% else %}
    {% render 'smart-breadcrumbs-page',
      debug_mode: debug_mode,
      enable_schema: block.settings.enable_schema
    %}
{% endcase %}

{% schema %}
{
  "name": "Smart Breadcrumbs",
  "target": "section",
  "settings": [
    {
      "type": "header",
      "content": "Breadcrumb Settings"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#f8f9fa"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#212529"
    },
    {
      "type": "color",
      "id": "link_color",
      "label": "Link Color",
      "default": "#0d6efd"
    },
    {
      "type": "text",
      "id": "separator",
      "label": "Separator",
      "default": "â€º"
    },
    {
      "type": "header",
      "content": "Advanced Settings"
    },
    {
      "type": "checkbox",
      "id": "hide_on_mobile",
      "label": "Hide on mobile devices",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "enable_schema",
      "label": "Enable Schema Markup (SEO)",
      "default": true,
      "info": "Adds structured data for improved SEO"
    }
  ]
}
{% endschema %} 