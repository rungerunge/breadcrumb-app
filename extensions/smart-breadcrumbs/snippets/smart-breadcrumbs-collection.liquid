{% comment %}
    Smart Breadcrumbs - Collection Template
    Version: 2.0.0
    
    This snippet generates breadcrumbs for collection pages with improved error handling
    and mobile responsiveness.
{% endcomment %}

{%- style -%}
.smart-breadcrumbs {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    padding: 10px 0;
    margin: 0;
    list-style: none;
    font-size: var(--breadcrumb-font-size, 14px);
}

.smart-breadcrumbs__item {
    display: flex;
    align-items: center;
}

.smart-breadcrumbs__link {
    color: var(--breadcrumb-color, #666);
    text-decoration: none;
    transition: color 0.2s ease;
}

.smart-breadcrumbs__link:hover {
    color: var(--breadcrumb-hover-color, #000);
}

.smart-breadcrumbs__separator {
    margin: 0 8px;
    color: var(--breadcrumb-separator-color, #999);
}

.smart-breadcrumbs__current {
    color: var(--breadcrumb-current-color, #333);
    font-weight: 500;
}

@media screen and (max-width: 768px) {
    .smart-breadcrumbs {
        font-size: var(--breadcrumb-mobile-font-size, 12px);
        padding: 8px 0;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
    }
    
    .smart-breadcrumbs::-webkit-scrollbar {
        display: none;
    }
    
    .smart-breadcrumbs__separator {
        margin: 0 4px;
    }
}
{%- endstyle -%}

<nav class="smart-breadcrumbs" aria-label="breadcrumb">
    <ol class="smart-breadcrumbs__list">
        {% comment %} Home Link {% endcomment %}
        <li class="smart-breadcrumbs__item">
            <a href="/" class="smart-breadcrumbs__link">{{ 'general.breadcrumbs.home' | t }}</a>
            <span class="smart-breadcrumbs__separator" aria-hidden="true">/</span>
        </li>

        {% comment %} Parent Collection Link (if available) {% endcomment %}
        {% if collection.metafields.custom.parent_collection %}
            {% assign parent_collection = collections[collection.metafields.custom.parent_collection] %}
            {% if parent_collection %}
                <li class="smart-breadcrumbs__item">
                    <a href="{{ parent_collection.url }}" class="smart-breadcrumbs__link">{{ parent_collection.title }}</a>
                    <span class="smart-breadcrumbs__separator" aria-hidden="true">/</span>
                </li>
            {% endif %}
        {% endif %}

        {% comment %} Current Collection {% endcomment %}
        <li class="smart-breadcrumbs__item">
            <span class="smart-breadcrumbs__current" aria-current="page">{{ collection.title }}</span>
        </li>
    </ol>
</nav>

{% comment %} Error Handling {% endcomment %}
{% unless collection %}
    {% comment %} Log error for debugging {% endcomment %}
    {% capture error_message %}
        Smart Breadcrumbs Error: Collection object not available
        Template: {{ template }}
        URL: {{ request.path }}
    {% endcapture %}
    {% comment %} You can add custom error logging here {% endcomment %}
{% endunless %} 